#!/bin/sh

prefix=/usr

while : ; do
  case "$1" in
    "") break;;
    --prefix)
      prefix=$2; shift;;
    *)
      >&2 echo "Unknown option \"$1\".";;
  esac
  shift
done

arch=`cat $prefix/lib/ocaml/Makefile.config | grep '^ARCH' | sed -e s/ARCH=//g`

echo "# gmp configuration" > Makefile.config

tool_prefix="$arch-pc-linux-musl-"
echo "AR=${tool_prefix}ar" >> Makefile.config
echo "RANLIB=${tool_prefix}ranlib" >> Makefile.config
echo "CC=${tool_prefix}gcc" >> Makefile.config
echo "PREFIX=${prefix}" >> Makefile.config
